<section class="my-5">
  <a name="printers"></a>
  <h1>Printers</h1>
  <div id="printers" class="row bg-white pt-4 pb-4"></div>
</section>

<script>

function updatePrinters(tpl, printers) {
  for (var i in printers) {
    var printerTemplate = $(tpl).clone();

    $(printerTemplate).find(".card-img-top").attr('src',printers[i].printerIcon);
    $(printerTemplate).find(".avatar img").attr('src',printers[i].filamentIcon);
    $(printerTemplate).find(".chip img").attr('src',printers[i].jobIcon);
    $(printerTemplate).find(".chip img").attr('src',printers[i].jobIcon);
    $(printerTemplate).find(".card-body h4").html(printers[i].statusText);
    $(printerTemplate).find(".chip span").html(printers[i].jobTitle);
    $(printerTemplate).find(".progress-bar").css('width',printers[i].progress + '%');

    if (printers[i].status=='idle') {
      $(printerTemplate).find(".btnPrint").show();
      $(printerTemplate).find(".btnStop").hide();
      $(printerTemplate).find(".progress").hide();
      $(printerTemplate).find(".chip").hide();
    } else {
      $(printerTemplate).find(".btnPrint").hide();
      $(printerTemplate).find(".btnStop").show();
      $(printerTemplate).find(".progress").show();
      $(printerTemplate).find(".rotate-btn").hide();      
    }

    $("#printers").append(printerTemplate);
  }
}

$.get("printer.html",function(tpl, textStatus) {
  $.get(window.settings.ip + "/printers", function(printers, status) {
    window.data.printers = printers;
    updatePrinters(tpl, printers);
  });
},"html");


</script>